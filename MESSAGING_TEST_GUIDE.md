# 即时通讯系统快速测试指南

## 🚀 快速开始

### 1. 启动系统
```bash
cd /Users/wyh/Documents/AIIgnite/AIIgniteNote
docker-compose up -d
```

系统会启动三个容器：
- ✅ 后端服务 (http://localhost:3215)
- ✅ 前端应用 (http://localhost:3210)
- ✅ 数据库 (localhost:5434)

### 2. 访问应用
打开浏览器，访问: **http://localhost:3210**

---

## 📝 功能测试清单

### ✅ 表情功能测试
1. 打开聊天窗口
2. 点击工具栏中的表情按钮 😊
3. **预期**: 弹出表情选择器面板
4. 点击表情分类选项卡（如"👋 人物"）
5. **预期**: 显示该分类的表情
6. 点击一个表情（如"👋"）
7. **预期**: 表情直接插入到输入框

**验证点**:
- [ ] 表情选择器弹出正确
- [ ] 分类选项卡正常切换
- [ ] 表情正确插入
- [ ] 消息发送后表情显示正确

---

### ✅ 文件上传功能测试
1. 点击工具栏文件按钮 📎
2. **预期**: 打开文件选择对话框
3. 选择一个或多个文件
4. **预期**: 显示绿色上传成功通知
5. 在消息列表中查看
6. **预期**: 消息显示 "📎 [文件] filename.ext (size KB)"

**验证点**:
- [ ] 文件选择对话框打开
- [ ] 支持多文件选择
- [ ] 显示上传成功通知
- [ ] 消息中包含文件图标和文件信息
- [ ] 消息时间戳正确

---

### ✅ 截图功能测试
1. 点击工具栏截图按钮 📸
2. **预期**: 出现确认对话框
3. 在消息列表中查看
4. **预期**: 消息显示 "📸 [截图] screenshot-timestamp.png"

**验证点**:
- [ ] 截图按钮正常工作
- [ ] 消息显示截图图标
- [ ] 消息时间戳正确

---

### ✅ @提及功能测试
1. 在输入框中输入 **@**
2. **预期**: 弹出成员选择下拉框
3. 在下拉框中选择一个成员
4. **预期**: "@用户名" 插入到输入框
5. 继续输入其他内容，如 "你好啊"
6. 按 Enter 发送消息
7. 在消息列表中查看
8. **预期**: 消息显示 "💬 @用户名 你好啊"

**验证点**:
- [ ] @ 字符触发成员列表
- [ ] 成员名称正确显示
- [ ] 点击成员正确插入
- [ ] 消息中显示提及标记

---

### ✅ 消息显示功能测试
1. 在两个用户间发送几条消息
2. **预期**: 消息实时显示
3. 验证消息内容包含：
   - 发送者头像（首字母）
   - 发送者用户名
   - 消息内容
   - 消息时间戳 (HH:mm 格式)
   - 自己的消息为绿色背景

**验证点**:
- [ ] 消息实时更新
- [ ] 发送者信息正确
- [ ] 时间戳显示正确
- [ ] 消息样式正确区分

---

### ✅ 聊天室管理测试
1. 在"联系人"标签页查看在线用户
2. **预期**: 显示所有在线用户列表
3. 点击一个在线用户
4. **预期**: 创建或打开与该用户的私聊
5. 检查"消息"标签页
6. **预期**: 新聊天室显示在列表中

**验证点**:
- [ ] 在线用户列表显示
- [ ] 支持创建新的私聊
- [ ] 聊天室列表更新

---

### ✅ 输入功能测试
1. 在输入框中输入消息
2. 按 **Enter** 键
3. **预期**: 消息直接发送
4. 再次输入，按 **Shift+Enter**
5. **预期**: 消息换行（如果支持）

**验证点**:
- [ ] Enter 键发送消息
- [ ] 输入框清空
- [ ] 发送按钮启用/禁用状态正确

---

### ✅ UI 交互测试
1. 拖拽聊天窗口
2. **预期**: 窗口可自由移动
3. 点击最小化按钮 **-**
4. **预期**: 窗口最小化
5. 点击展开按钮 **+**
6. **预期**: 窗口展开
7. 点击关闭按钮 **×**
8. **预期**: 聊天窗口关闭

**验证点**:
- [ ] 拖拽功能正常
- [ ] 最小化/展开正常
- [ ] 关闭功能正常

---

## 🧪 综合场景测试

### 场景 1: 完整的群聊对话
```
用户 A: 你好 😊
用户 B: 你好啊 👋
用户 A: @用户 B 这是一条重要的消息
用户 B: 📎 上传了文件
用户 A: 📸 发送了截图
```

**预期结果**:
- ✅ 所有消息实时显示
- ✅ 消息类型正确标记
- ✅ 时间戳准确
- ✅ 消息持久化到数据库

---

### 场景 2: 表情和提及组合
```
用户输入: "@团队 今天天气很好 😊 🌞"
发送消息
```

**预期结果**:
- ✅ 消息包含提及标记
- ✅ 表情正确显示
- ✅ 消息完整且可读

---

## 🔍 故障排查

### 问题 1: 表情选择器不显示
**解决方案**:
- 检查浏览器控制台是否有 JavaScript 错误
- 清除浏览器缓存，刷新页面
- 验证前端容器是否正常运行: `docker-compose logs frontend`

### 问题 2: 消息未实时显示
**解决方案**:
- 检查 Socket.IO 连接: 打开浏览器开发者工具 → Network
- 验证后端容器: `docker-compose logs backend`
- 检查数据库连接: 查看 PostgreSQL 日志

### 问题 3: 文件上传失败
**解决方案**:
- 验证后端服务运行状态
- 检查浏览器开发者工具 → Console
- 查看后端日志中的错误信息

### 问题 4: 页面加载缓慢
**解决方案**:
- 检查网络连接
- 清除浏览器缓存
- 检查 Docker 资源使用情况: `docker stats`

---

## 🛠️ 调试命令

### 查看容器状态
```bash
docker-compose ps
```

### 查看实时日志
```bash
# 后端日志
docker-compose logs -f backend

# 前端日志
docker-compose logs -f frontend

# 数据库日志
docker-compose logs -f postgres
```

### 进入容器
```bash
# 进入后端容器
docker-compose exec backend bash

# 进入前端容器
docker-compose exec frontend sh
```

### 重启服务
```bash
# 重启所有服务
docker-compose restart

# 重启特定服务
docker-compose restart backend
```

### 查看数据库
```bash
# 连接到数据库
docker-compose exec postgres psql -U postgres -d ai_ignite_note

# 查看消息表
SELECT * FROM "ChatMessage" LIMIT 10;

# 查看聊天室
SELECT * FROM "ChatRoom" LIMIT 10;
```

---

## 📊 性能测试

### 测试1: 消息吞吐量
发送 100 条消息，记录时间
**预期**: < 5秒完成

### 测试2: 并发连接
5 个用户同时连接
**预期**: 所有用户正常工作

### 测试3: 消息加载
加载 1000 条历史消息
**预期**: < 2秒加载完成

---

## ✅ 最终验收标准

- [ ] 所有 Docker 容器正常运行
- [ ] 表情选择器工作正常
- [ ] 文件上传功能完整
- [ ] 截图消息正确显示
- [ ] @提及功能可用
- [ ] 消息实时显示
- [ ] 消息持久化存储
- [ ] 用户信息显示完整
- [ ] UI 交互流畅
- [ ] 无 JavaScript 错误

---

## 📞 技术支持

如遇到问题，请：
1. 检查 Docker 容器日志
2. 查阅源代码文件
3. 参考系统架构文档

**系统已就绪，祝测试顺利！** 🎉
